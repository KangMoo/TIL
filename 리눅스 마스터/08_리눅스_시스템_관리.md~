## 일반 운영 관리

### 사용자 관리

#### 일반 사용자 관리

- su 명령어
  - 다른 사용자로 전환하는 명령어
  - 주요 옵션
    - [-] : 전환하는 사용자의 초기화 파일을 실행
      > `# su -root` : root의 환경변수를 적용하고 전환
    - [-c] : 계정 변환 없이 특정 명령어만 실행 (sudo 명령어와 같은 기능)
      > `# su -c 'cat /etc/passwd' -root` : root 권한으로 해당 명령을 실행
  - su 명령어로 사용자 전환 후의 위치는 동일

- root 계정관리
  - root 계정의 UID 값은 0이다
  - root 이외의 UID가 0인 사용자가 없도록 해야한다
  - TMOUT 환경변수를 사용해 일정시간 미사용시 자동으로 로그아웃 되도록 설정하여 보안을 강화한다
  - 일반 사용자에게 특정 명령어에 대한 root 권한이 필요할 때는 su 명령어보다는 sudo 명령어를 ㅣ용하도록 한다.

#### 사용자 계정 관리

- 계정 관리 관련 파일
  - /etc/passwd 파일
    - 파일 내용 구성
      > `[user_account] : [user_password] : [UID] : [GID] : [comment] : [home_directory] : [login_shell]`
      > - user_account : 사용자 계정
      > - user_password : /etc/shadow 파일에 암호돠되어 저장되어 있다
      > - UID : User ID. 보통 100번 이하는 시스템이 사용, 0qjsdms tltmxpa rhksflwkfmf skxksosek
      > - GID : Group ID
      > - comment
      > - home_directory : 로그인 성공 후에 사용자가 위치할 홈 디렉토리의 절대경로
      > - login_shell : 로그인 셸의 절대경로
  - /etc/shadow 파일
    - 파일 내용 구성
      > `[user_id] : [encryption_pw] :[last_change] : [minilife] : [maxlife] : [warn] : [inactive] : [expires]
      > - user_id : 사용자 계정
      > - encryption_pw : 일방향 해시 알고리즘을 암호화한 패스워드
      > - last_change : 마지막으로 패스워드를 변경한 날
      > - minilife : 최소 패스워드 변경 일수 (패스워드를 변경할 수 없는 기간)
      > - maxlife : 최대 패스워드 변경 일수 (패스워드 변경 없이 사용할 수 있는 일수)
      > - warn : 경고 일수 (maxlife 필드에 지정한 일수가 얼마 남지 않았음을 알림)
      > - inactive : 최대 비활성 일수
      > - expires : 계정이 만료되는 날
    - enctyption_pw 필드의 기호 뜻
      > * : 패스워드 잠긴 상태. 별도의 인증방식을 사용하여 로그인
      > !! : 패스워드 잠긴 상태. 모든 로그인이 불가능
      > 빈 값 : 패스워드가 설정되지 않은 상태
  - /etc/login.def 파일
    - 사용자 계정의 설정과 기본 값을 정의한 파일
    - 기본 메일 디렉토리, 패스워드 에이징, 사용자 계정의 UID/GID값 범위 등의 기본값을 설정할 수 있음
  - /etc/skel 디렉토리
    - 사용자 계정 생성 시 공통으로 배포할 파일이나 디렉토리를 지정하는 디렉토리
  - /etc/default/useradd 파일
    - useradd 명령어로 계정 생성 시 기본 값을 지정한 파일

#### 그룹 계정 관리

- 그룹 관리 관련 파일
  - /etc/group 파일
    - 파일 내용 구성 : 그룹 명 : 그룹 패스워드 : GID : 그룹 멤버
    - /etc/passwd 파일에는 기본 그룹의 GID가 저장되고, /etc/group 파일에는 2차 그룹의 정보가 저장
  - /etc/gshadow 파일
    - 파일 내용 구성 : 그룹 명 : 암호화 된 그룹 패스워드 : 관리자 : 그룹 멤버

#### 관련 명령어

- useradd 명령어
  - 사용자 계정을 생성하는 명령어
  - 주요 옵션
    - [-u] : UID 지정
    - [-o] : UID의 중복을 허용
    - [-g] : 기본 그룹의 GID 지정
    - [-G] : 2차 그룹의 GID 지정
    - [-d] : 홈 디렉토리 지정
    - [-s] : 기본 쉘을 지정
    - [-c] : 코멘트 지정
    - [-D] : 기본 값을 설정하거나 출력 (/etc/default/useradd 파일 내용)
    - [-e] : 유효 기간 지정 (/etc/shadow 파일의 expires 항목)
    - [-f] : 비활성 일수 지정 (/etc/shadow 파일의 inactive 항목)
      > `# useradd -u 500 -G 10 -s /bin/bash -e 2018-12-31 testuser` : testuser사용자의 UID는 500, GID가 10인 2차 그룹, 기본 쉘은 bash, 유효기간은 2018-12-31까지로 설정하여 생성
  - 옵션 없이 계정 생성할 경우 패스워드를 설정하지 않았기 때문에 /etc/shadow 파일에 패스워드 항목이 `!!`로 지정되어 있다 (패스워드가 잠겨 있다는 기호)

- usermod 명령어
  - 사용자 계정의 정보를 변경하는 명령어
  - 주요 옵션
    - useradd 명령어와 옵션이 동일
    - [-l] : 게정 이름 변경
      > `# useradd -l usertest testuser` testuser 사용자의 이름을 usertest로 변경

- userdel 명령어
  - 사용자 계정을 삭제하는 명령어
  - [-r] 옵션 : 홈 디렉토리 제거

- chage 명령어
  - 패스워드 에이징에 관한 설정을 하는 명령어
  - 주요 옵션
    - [-m] : /etc/shadow 파일의 minilife 항목 설정 (passwd -n)
    - [-M] : /etc/shadow 파일의 maxlife 항목 설정 (passwd -x)
    - [-W] : /etc/shadow 파일의 warn 항목 설정 (passwd -w)
    - [-l] : /etc/shadow 파일의 inactive 항목 설정 (usermod -f)
    - [-E] : /etc/shadow 파일의 expires 항목 설정 (usermod -e)

- passwd 명령어
  - 사용자 계정의 패스워드 변경/관리하는 명령어
  - 주요 옵션
    - [-n] : /etc/shadow 파일의 minilife 항목 설정
    - [-x] : /etc shadow 파일의 maxlife 항목 설정
    - [-w] : /etc/shadow 파일의 warn 항목 설정
    - [-l] : 계정 잠금
    - [-u] : 계정 잠금 해제

- groupadd 명령어
  - 그룹을 생성하는 명령어
  - 주요 옵션
    - [-g] : GID 지정
    - [-d] : GID의 중복을 허용

- groupmod 명령어
  - 그룹의 정보를 변경하는 명령어
  - 주요 옵션
    - groupadd 명령어와 옵션이 동일
    - [-n] : 그룹 이름 변경

- groupdel 명령어
  - 그룹을 삭제하는 명령어

- gpasswd 명령어
  - 그룹의 패스워드를 변경하거나 그룹에 계정을 추가/삭제하는 명령어
  - 주요 옵션
    - [-a] : 사용자 계정을 그룹에 추가
      > `#gpasswd리 -a testuser testgroup` : testgroup 그룹에 testuser 사용자를 추가
    - [-d] : 사용자 계정을 그룹에서 삭제
    - [-r] : 그룹 암호를 삭제
    - [-A] : 그룹의 관리자를 지정
      > `# gpasswd -A testuser testgroup` : testgroup 그룹의 관리자를 testuser 사용자를 관리자로 설정

- newgrp 명령어
  - 계정의 소속 그룹을 변경하는 명령어
    > `# newgrp grp01` : grp01로 그룹을 변경

- 사용자 정보 확인 명령어
  - who 명령어 : 현재 시스템을 사용하는 사용자의 정보를 출력하는 명령어
    - [-q] : 사용자의 이름만 출력
    - [-H] : 출력 항목의 제목도 함께 출력
    - [-b] : 마지막으로 재시작한 날짜와 시간을 출력
    - [-r] : 현재 런레벨을 출력
  - w 명령어 : 현재 시스템을 사용하느 사용자의 정보와 작업 정보를 출력하는 명령어
  - whoami 명령어 : 현재 작업하고 있는 자신의 계정을 출력
  - id 명령어 : 현재 작업하고 있는 자신의 계정명, 그룹명, UID, GID를 출력하는 명령어
  - users 명령어 : 현재 로그인 되어 있는 사용자의 계정을 출력
  - gropus 명령어 : 사용자 계정이 속한 그룹을 출력
  - lslogins 명령어 : 시스템 내에 있는 사용자 계정에 대한 정보를 출력

- 무결성 검사 명령어
  - pwck 명령어 : /etc/passwd 파일과 /etc/shadow 파일 내용의 무결성을 검사하는 명령어
  - grpck 명령어 : /etc/group 파일과 /etc/gshadow 파일 내용의 무결성을 검사하는 명령어

### 파일 시스템 관리

#### 파일 및 디렉토리 관리

- ls -l 명령어ㅓ 수행시 각 필드 항목
|파일 종류|파일 권한|하드링크 수|소유자|소유 그룹|크기|마지막 수정 시간|파일 명|
|---|---|---|---|---|---|---|
|d|rwxr-xr-x|3|fedora|fedora|4096|7월 26 21:41|linuxmaster|
