# EC2 인스턴스 스토리지 섹션

## EBS 볼륨이란

- Elastic Block Store
- 기동중인 인스턴스에 연결할 수 있는 네트워크 드라이버
- 인스턴스 종료 후에도 데이터를 유지할 수 있게 해준다
  - 인스턴스 속성으로 종료 시 데이터를 삭제하도록 변경 가능하다
- **EBS 볼륨은 한버너에 하나의 인스턴스에만 마운트 가능하다**
- 특정 가용영역에 바인딩된다

> EBS 볼륨 = 네트워크 USB 스틱같은 거라고 생각하면 이해하기 쉽다
> - 한번에 하나의 컴퓨터에만 연결 가능 = EBS 볼륨은 하나의 인스턴스에만 연결 가능
> - 한 컴퓨터에 여러개의 USB 스틱 연결 가능 = 하나의 인스턴스는 여러개의 EBS 볼륨에 연결 가능
> - 컴퓨터 종료 후에도 데이터 유지 = 인스턴스 종료 후에도 EBS 볼륨의 데이터 유지


## EBS 볼륨

- 네트워크 드라이브다 (물리적 드라이브가 아니다)
  - 네트워크를 통해 인스턴스와 통신하므로 약간의 지연시간이 있을 수 있다.
  - 빠르고 쉽게 EC2 인스턴스에서 분리하고 다른 인스턴스에 연결할 수 있다

- 가용영역에 묶여있다
  - 서로 다른 가용영역에서 EBS 볼륨에 접근이 불가능하다
  - 가용영역을 넘나들려면 스냅샷을 만들어 다른 가용영역으로 복사해야 한다

- 프로비저닝된 용량이 있다
  - 프로비저닝된 용량에 대해 요금이 청구된다
  - 추후 드라이브의 용량을 늘릴 수 있다

### EBS 종료 시 삭제 속성

- EC2 인스턴스 종료 시 EBS 볼륨의 동작을 컨트롤할 수 있다
  - 기본값 : root EBS 볼륨은 삭제되며, 연결된 다른 EBS 볼륨은 삭제되지 않음
- 인스턴스 생성 시 속성을 설정하거나, AWS 콘솔 / AWS CLI 로 컨트롤 할 수 있다

### EBS 스냅샷

- 특정 시점에 EBS 볼륨을 백업할 수 있다 (스냅샷 생성)
- 스냅샷을 만들기위해서 연결 해제할 필요는 없지만, 보통 연결 해제가 권장된다
- 가용영역/리전을 넘어 스냅샷을 만들 수 있다
  - EBS 볼륨은 기본적으로 가용영역/리전에 제한적으로 사용 가능하다
  ![snapshot_across_az](./images/04_01.png)



## AMI

### 개요

- Amazon Machine Image
- AMI = 커스텀 EC2 인스턴스
  - EC2 인스턴스에 소프트웨어, 설정값, OS, 모니터링 .. 등등 추가할 수 있다
  - 모든 소프트웨어가 이미 설치되어있기 때문에 빠르게 기동 및 구성이 가능하다
- AMI는 리전에 한정되어 있다 (다른 리전으로 복사하여 넘겨줄 수 있다)

### AMI Process

1. EC2인스턴스 시작 및 커스터마이즈
2. 인스턴스 중지 (데이터 무결성을 위해)
3. AMI 생성 - 이 과정은 EBS 스냅샷 생성 과정을 동반한다
4. AMI로 다른 인스턴스 생성

  ![AMI 생성 과정](./images/04_02.png)


## EC2 인스턴스 스토어

- EBS 볼륨은 네트워크 드라이브이므로 성능에 한계가 있다
- **높은 성능의 하드웨어 디스크가 필요하다면, EC2 인스턴스 스토어를 사용해야 한다**

### EC2 인스턴스 스토어 특징

- EBS 볼륨보다 더 좋은 I/O 성능
- EC2 인스턴스 스토오는 중단될 시 스토리지가 손실된다 (휘발성)